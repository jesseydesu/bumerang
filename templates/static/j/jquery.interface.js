var cropText = function(txtElement, container_to_fit, widthLimit){	var txt = txtElement.get(0).innerHTML;	var i=0;	if(container_to_fit.width() > widthLimit){		while (container_to_fit.width() > widthLimit){			txt = txt.substr(0,txt.length - 1)			txtElement.html(txt+'...');			i++;			if (i > 100) {				break;			}		}	}		if(txtElement.width() > 0){		container_to_fit.get(0).style.width = widthLimit + 'px';	}}function getPopup(link, popId) {	var pop = $("#" + popId);	var lnk = $(link);	var close = pop.find('.b-popup__close');		if (lnk.hasClass("act")) {		lnk.removeClass("act");		$('#tint').hide();		pop.hide();		removeEvent(document, "click", popClickFunc)	}	else {		if (popBlock != null && popLnk != null) {			$(popBlock).hide();			$(popLnk).removeClass("act");			removeEvent(document, "click", popClickFunc);		}		lnk.addClass("act");		$('#tint').show();		pop.css('margin-left', - pop.width() / 2 + 'px');		pop.show();		popLnk = link;		popBlock = pop.get(0);		popClose = close.get(0);		addEvent(document, 'click', popClickFunc);	}	return false;}var popLnk, popBlock, popClose;function popClickFunc(event) {	var event = event || window.event;	var t = event.target || event.srcElement;	if (t != popLnk && !isChildNode(popLnk, t) && (t == popClose || isChildNode(popClose, t) || !isChildNode(popBlock, t))) {		$(popBlock).hide();		$('#tint').hide();		$(popLnk).removeClass("act");		removeEvent(document, "click", popClickFunc);	}	return false;}function addEvent(obj, type, fn) {	if (obj.addEventListener)		obj.addEventListener(type, fn, false);	else if (obj.attachEvent)		obj.attachEvent( "on"+type, fn );}function removeEvent(obj, type, fn) {	if (obj.removeEventListener)		obj.removeEventListener(type, fn, false);	else if (obj.detachEvent)		obj.detachEvent( "on"+type, fn );}function isChildNode(elem, sell) {	for (var childItem in elem.childNodes) {		if (elem.childNodes[childItem].nodeType == 1) {			if (elem.childNodes[childItem] == sell)				return true;			else if (isChildNode(elem.childNodes[childItem], sell))				return true;		}	}	return false;}$(document).ready(function(){		/* Button */	$('.b-button')		.not('.disabled')		.bind('click', function(){			$(this).blur();			return false		})		.bind('mousedown', function(){			$(this).addClass('pressed')		})		.bind('mouseup', function(){			$(this).removeClass('pressed')		});	$('#now-brief').gradientText({colors: ['#666', '#999', '#ccc']});		/* Checkbox */  	$('.b-checkbox > input[type="checkbox"]')		.bind('change', function(){			if (!$(this).is(':checked')) {				$(this).parent('.b-checkbox').addClass('b-checkbox_checked');			} else {				$(this).parent('.b-checkbox').removeClass('b-checkbox_checked');			}		})		/* Radio */	$('fieldset .b-radio input[type="radio"]')		.bind('change', function(){			$(this).parent('.b-radio').addClass('b-radio_checked');			$('input[type="radio"][name="'+ $(this).attr('name') +'"]').not($(this)).parent('.b-radio_checked').removeClass('b-radio_checked');		})	/* Tabs */		$('.b-tabs dl > dt').bind('click', function(){		$(this)			.siblings().removeClass('selected').end()			.next('dd').andSelf().addClass('selected');	})	/* Select */	var params = {		changedEl:".b-form__field .f-select select",		visRows:5,		scrollArrows:false	}		try {		cuSel(params);	}	catch(err){	}	/* Toggle */	function Toggle(lnk, block, text) {		lnk.bind('click', function(){			if (block.is(':hidden')) {				block.slideDown('fast');				text.empty().text('Скрыть');				return false;			} else {				block.slideUp('fast');				text.empty().text('Показать');				return false;			}		})	}	$('.js-toggle').each(function(){		var lnk = $(this).find('.b-pseudolink');		var block = $(this).next('div');		var text = lnk.find('.js-toggle-text');		Toggle(lnk, block, text);	})			$('.js-toggle2-container').each(function(){		var lnk = $(this).find('.js-toggle2-lnk');		var block = $(this).find('.js-toggle2-block');		var text = $(this).find('.js-toggle2-text');				Toggle(lnk, block, text);	})			/* Change text */	$('.js-changable').each(function(){		var ctrl = $(this).find('.js-ctrl');		var text = $(this).find('.js-text');		var currentField = $(this).parents('.b-form__field');		var nextField = currentField.next('.b-form__field');		var input = nextField.find('.js-input');				ctrl.bind('click', function(){			currentField.hide();			nextField.show();			input.focus().select();		})	})		/* Advertising */	$('.b-adv__close').bind('click', function(){		$(this).parents('.b-adv').hide();	})		/* Dropdown */	$('.b-dropdown__handle').bind('click', function(){		$(this).parents('.b-dropdown').toggleClass('b-dropdown_open');				return false;	})});